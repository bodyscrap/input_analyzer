# サイバーボッツ入力履歴エディタ - 操作マニュアル

## 概要

このアプリケーションは、サイバーボッツのゲーム画面動画から入力履歴を自動抽出し、編集・保存するためのツールです。

## 主な機能

- 動画ファイルから入力履歴を自動抽出
- CSV形式での入力履歴の編集
- 複数行の選択、コピー、貼り付け
- 入力履歴の追加・削除
- GPU/CPUでの推論切り替え

## 基本操作

### 新規作成

1. メニューバー → ファイル → 新規作成
2. 初期状態として1行（1F持続、無入力）が作成されます

### 動画から抽出

1. メニューバー → ファイル → 開く (CSV/動画)
2. MP4, AVI, MOV, MKVファイルを選択
3. 進捗ダイアログが表示され、自動的に入力履歴を抽出
4. 抽出中にキャンセルボタンで中断可能

**注意**: 動画抽出にはモデルファイルの選択が必要です（設定メニュー）

### CSVファイルを開く

1. メニューバー → ファイル → 開く (CSV/動画)
2. CSVファイルを選択
3. 入力履歴が読み込まれます

### 保存

#### 上書き保存
- メニューバー → ファイル → 保存
- 現在のファイルに上書き保存

#### 名前を付けて保存
- メニューバー → ファイル → 名前を付けて保存
- 新しいファイル名で保存

## 編集操作

### 行の選択

- **単一選択**: 行番号をクリック
- **複数選択（追加）**: Ctrl + クリック
- **範囲選択**: Shift + クリック
- **全選択**: Ctrl + A

### コピー・貼り付け

| 操作 | キーボード | メニュー |
|------|-----------|---------|
| コピー | Ctrl + C | 編集 → コピー |
| 切り取り | Ctrl + X | 編集 → 切り取り |
| 貼り付け | Ctrl + V | 編集 → 貼り付け |

- 貼り付けは選択行の次に挿入されます
- 選択がない場合は末尾に追加されます

### 行の追加

- メニューバー → 編集 → 新規レコード追加
- 各行の「➕」ボタン: その行の後に追加
- 複数行選択時: 一番下の選択行の下に追加

### 行の削除

| 操作 | キーボード | メニュー | 行ボタン |
|------|-----------|---------|---------|
| 削除 | Delete | 編集 → 選択レコード削除 | ❌ |

- 複数行選択時: 選択した全ての行を削除
- 最低1行は必ず残ります

### 入力値の編集

#### 持続フレーム数
- 数値をクリックして直接入力
- マウスドラッグで増減
- 範囲: 1 ～ 4,294,967,295

#### 方向入力
- ドロップダウンから選択
- 矢印で表示:
  - ↖ (7): 左上
  - ↑ (8): 上
  - ↗ (9): 右上
  - ← (4): 左
  - N (5): ニュートラル
  - → (6): 右
  - ↙ (1): 左下
  - ↓ (2): 下
  - ↘ (3): 右下

#### ボタン入力
- チェックボックスをクリックでON/OFF
- A1, A2, B, W, Start

## 設定

### 推論バックエンド

- **GPU (WGPU)**: 高速だが安定性が若干低い
- **CPU (NdArray)**: 低速だが安定

### モデルファイル

1. 「選択...」ボタンをクリック
2. `model.mpk`ファイルを選択
3. 未選択の場合、動画抽出は実行できません

### 動画長さ上限

- デフォルト: 120秒（2分）
- 設定可能範囲: 10秒 ～ 600秒（10分）
- 上限を超える動画は処理できません

## CSVフォーマット

### ファイル形式

```csv
duration,direction,btn_a1,btn_a2,btn_b,btn_w,btn_start
30,5,0,0,0,0,0
15,6,1,0,0,0,0
8,3,1,1,0,0,0
```

### 列の説明

| 列名 | 説明 | 値の範囲 |
|-----|------|---------|
| duration | 持続フレーム数 | 1 ～ 4,294,967,295 |
| direction | 方向入力 | 1-9 (5=ニュートラル) |
| btn_a1 | A1ボタン | 0=OFF, 1=ON |
| btn_a2 | A2ボタン | 0=OFF, 1=ON |
| btn_b | Bボタン | 0=OFF, 1=ON |
| btn_w | Wボタン | 0=OFF, 1=ON |
| btn_start | Startボタン | 0=OFF, 1=ON |

## キーボードショートカット一覧

| 機能 | キー |
|------|-----|
| コピー | Ctrl + C |
| 切り取り | Ctrl + X |
| 貼り付け | Ctrl + V |
| 全選択 | Ctrl + A |
| 削除 | Delete |

## ヒント

### 効率的な編集方法

1. **連続する同じ入力の修正**
   - 該当行をコピー
   - 必要な回数だけ貼り付け
   - フレーム数を調整

2. **複数行の一括削除**
   - Ctrlを押しながら複数行をクリック
   - Deleteキーで一括削除

3. **パターンの繰り返し**
   - Shift + クリックで範囲選択
   - コピー & 貼り付けで複製

### よくある質問

**Q: 抽出した入力履歴が正確でない**
- A: モデルの精度に依存します。抽出後に手動で修正してください

**Q: 動画抽出が遅い**
- A: 設定で「GPU (WGPU)」を選択すると高速化できます

**Q: 長い動画を処理したい**
- A: 設定メニューで「動画長さ上限」を増やしてください（最大10分）

**Q: ゲーム画面の解像度は関係ある？**
- A: 1920x1080を想定していますが、他の解像度でも動作する可能性があります

## トラブルシューティング

### キーボードショートカットが効かない

- 入力フィールドにフォーカスがない状態で実行してください
- ウィンドウをクリックしてフォーカスを確認

### コピー&ペーストができない

- 行が選択されているか確認（行番号が強調表示）
- Ctrl + C でコピー後、ステータスバーで確認

### 削除ボタンが無効

- 最低1行は必ず残す必要があります
- 全行を削除しようとしていないか確認

## サポート

問題や質問がある場合は、GitHubのIssueで報告してください。
